<div class="container">
    <header class="header">
        <div class="cover-wrapper">
            <img src="./assets/images/posts.jpg" class="cover-image" />
            <div class="overlay-content">
                <div class="header-inner-content">
                    <div class="title-section">
                        <h1 class="musicians" style="font-size:60px;">Posts & Vibes</h1>
                        <p style="font-size:25px;color:#fff">Create, share, and see the world through others' eyes</p>
                    </div>

                    <button class="button join-network-btn" (click)="navigateToUpload()">
                        Upload Post
                        <mat-icon>upload</mat-icon>
                    </button>
                </div>
            </div>
        </div>
    </header>

<section class="search-bar">
Â  Â  Â  Â  <div class="search-input-group">
Â  Â  Â  Â  Â  Â  <span class="search-icon">ğŸ”</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" placeholder="Search musicians by name, instrument, or skills..." />
Â  Â  Â  Â  </div>
Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  <select 
Â  Â  Â  Â  Â  Â  class="dropdown"
Â  Â  Â  Â  Â  Â  [(ngModel)]="selectedTimeRange" 
Â  Â  Â  Â  Â  Â  (change)="applyTimeFilter()">
Â  Â  Â  Â  Â  Â  Â  Â  <option value="All">All times</option>
Â  Â  Â  Â  Â  Â  Â  Â  <option value="Today">Current Day</option>
Â  Â  Â  Â  Â  Â  Â  Â  <option value="Week">Current Week</option>
Â  Â  Â  Â  Â  Â  Â  Â  <option value="Month">Current Month</option>
Â  Â  Â  Â  </select>
Â  Â  Â  Â  
Â  Â  Â  Â  <select class="dropdown">
Â  Â  Â  Â  Â  Â  <option>All</option>
Â  Â  Â  Â  </select>
<!-- 
Â  Â  Â  Â  <button class="filters-btn" (click)="toggleFilters()">
Â  Â  Â  Â  Â  Â  Filters <span class="arrow-icon">{{ showFilters ? 'âˆ§' : 'âˆ¨' }}</span>
Â  Â  Â  Â  </button> -->
Â  Â  </section>
    <!-- @if (showFilters) {
    <section class="additional-filters">
        <div class="filter-group">
            <label>Experience</label>
            <select class="dropdown">
                <option>Any Experience</option>
            </select>
        </div>

        <div class="filter-group">
            <label>Rating</label>
            <select class="dropdown">
                <option>Any Rating</option>
            </select>
        </div>

        <div class="filter-group">
            <label>Availability</label>
            <select class="dropdown">
                <option>Any Availability</option>
            </select>
        </div>

        <div class="filter-group">
            <label>Price Range</label>
            <select class="dropdown">
                <option>Any Price</option>
            </select>
        </div>
    </section>
    } -->

    @if(displayedPosts.length===0){
        <div class="empty-posts-container">
            <p class="empty-message">×¢×“×™×™×Ÿ ×œ× ×¤×•×¨×¡××• ×¤×•×¡×˜×™×. ×”×ª×—×œ ×œ×©×ª×£ ××ª ×”××•×–×™×§×” ×©×œ×š ×¢×›×©×™×•!</p>

            <button class="upload-post-button" routerLink="/post">...</button>
            <span style="font-size: 1.5em; margin-left: 10px;">ğŸ¶</span>
            ×”×¢×œ×” ××ª ×”×¤×•×¡×˜ ×”×¨××©×•×Ÿ ×©×œ×š
            <span style="font-size: 1.5em; margin-right: 10px;">â¬†ï¸</span>
        </div>
    }
    @else{

    @for(post of displayedPosts; track $index){

    <div class="post-card">

        <ng-container *ngIf="!isProfileView || showOnlyMedia === 'all'">
            <header class="post-header">
                <img class="avatar" [src]="fileUtils.getImageUrl(post.user?.imageProfilePath)" alt="avatar">

                <div class="user-info">
                    <span class="username">{{post.user?.name}}</span>
                    <span class="date">{{post.dateUploaded | date:'short'}}</span>
                </div>

                <button *ngIf="!isAdmin" class="action-btn report-btn" (click)="onReportPost(post.id!)">
                    <mat-icon>report</mat-icon> ×“×•×•×—
                </button>

                <div *ngIf="isAdmin" class="post-actions-wrapper">
                    <button class="action-btn more-actions-btn" (click)="toggleAdminActions(post.id!)">
                        <mat-icon>more_vert</mat-icon>
                    </button>
                    </div>
            </header>
        </ng-container>

        <div class="post-body">
            <ng-container *ngIf="!isProfileView || showOnlyMedia === 'all'">
                <h3 class="post-title">{{post.title}}</h3>
                <p class="post-content">{{post.content}}</p>
            </ng-container>

            <div class="post-media">
                <ng-container *ngIf="!isProfileView || showOnlyMedia === 'all'">
                    <div *ngFor="let image of post.imagesBase64" class="image-container">
                        <img [src]="fileUtils.getImageUrl(image)" class="post-image">
                    </div>
                </ng-container>

                <div *ngIf="post.audioPath && (showOnlyMedia === 'all' || showOnlyMedia === 'audio')" class="media-track-wrapper">
                    <h3 *ngIf="showOnlyMedia !== 'all'" class="media-title">{{post.title}}</h3>
                    <audio controls [src]="getSafeMediaUrl('audio/' + post.audioPath)"></audio>
                </div>

                <div *ngIf="post.videoPath && (showOnlyMedia === 'all' || showOnlyMedia === 'video')" class="media-video-wrapper">
                    <h3 *ngIf="showOnlyMedia !== 'all'" class="media-title">{{post.title}}</h3>
                    <video controls [src]="getSafeMediaUrl('video/' + post.videoPath)"></video>
                </div>
            </div>
        </div>

        <ng-container *ngIf="!isProfileView || showOnlyMedia === 'all'">
            <footer class="post-footer">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
                <div class="stats">
                    <div class="post-rating">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="rating-value">{{ post.rating | number:'1.1-1' }}</span>
<div class="stars-wrapper">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  @for (starType of getStarArray(post.rating); track $index) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <mat-icon 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  class="star-icon" 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  [ngClass]="{'filled-star': starType !== 'star_border'}">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  {{ starType }}
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </mat-icon>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>


                    <span>â¤ï¸ {{post.hearts}}</span>
                    <span>ğŸ‘ {{post.likes}}</span>
                </div>
            </footer>
            <hr>
        </ng-container>

        <ng-container *ngIf="!isProfileView || showOnlyMedia === 'all'">
            <div class="comments-actions-row">
                <button class="view-comments-btn" (click)="toggleComments(post.id!)">
                    {{ showComments[post.id!] ? '×¡×’×•×¨ ×ª×’×•×‘×•×ª' : '×¦×¤×™×™×” ×‘×ª×’×•×‘×•×ª' }}
                </button>
                <button class="add-comment-page-btn" (click)="navigateToAddComment(post.id!)">
                    ×”×•×¡×£ ×ª×’×•×‘×” <mat-icon>add_comment</mat-icon>
                </button>
            </div> Â  Â  Â 

            <div class="comments-wrapper" 
                *ngIf="showComments[post.id!]" 
                [class.open]="showComments[post.id!]">
                
                <app-comment [postId]="post.id!"></app-comment>
            </div>
        </ng-container>

    </div>
}
    }
    <br><br><br>
</div>