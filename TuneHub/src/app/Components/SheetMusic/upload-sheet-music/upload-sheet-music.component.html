@if(uploadSheetMusicService.isOpen){
<div class="modal-backdrop" (click)="onCancel()"> 
Â  Â  <div class="modal-container" (click)="$event.stopPropagation()">
Â  Â  Â  <div class="modal-header">
Â  Â  Â  Â  <h2>Upload Music Sheet</h2>
Â  Â  Â  Â  <button class="close-btn" (click)="onCancel()">
Â  Â  Â  Â  Â  <span aria-hidden="true" >&times;</span>
Â  Â  Â  Â  </button>
Â  Â  Â  </div>

Â  Â  Â  <form [formGroup]="uploadForm" (ngSubmit)="onSubmit()">
Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  <div class="input-row">
Â  Â  Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  Â  Â  <label for="title">Title</label>
Â  Â  Â  Â  Â  Â  <input id="title" type="text" formControlName="title" placeholder="Sheet title..." required />
            @if (uploadForm.get('title')?.invalid && uploadForm.get('title')?.touched) {
                <div class="error-message">Title is required.</div>
            }
Â  Â  Â  Â  Â  </div>
          
Â  Â  Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  Â  Â  <label for="key">Key / Scale</label>
Â  Â  Â  Â  Â  Â  <select id="key" formControlName="key" required>
Â  Â  Â  Â  Â  Â  Â  <option value="" disabled>Select key...</option>
              @for (scale of scaleOptions; track scale) {
                <option [value]="scale">{{ scale }}</option>
              }
Â  Â  Â  Â  Â  Â  </select>
            @if (uploadForm.get('key')?.invalid && uploadForm.get('key')?.touched) {
                <div class="error-message">Key/Scale is required.</div>
            }
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="input-row">
Â  Â  Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  Â  Â  <label for="category">Category</label>
Â  Â  Â  Â  Â  Â  <select id="category" formControlName="category" required>
Â  Â  Â  Â  Â  Â  Â  <option value="" disabled>Select category...</option>
              @for (cat of categories; track cat.id) {
Â  Â  Â  Â  Â  Â  Â    <option [value]="cat.id">{{ cat.name }}</option>
              }
Â  Â  Â  Â  Â  Â  </select>
            @if (uploadForm.get('category')?.invalid && uploadForm.get('category')?.touched) {
                <div class="error-message">Category is required.</div>
            }
Â  Â  Â  Â  Â  </div>
          
          <div class="input-group">
Â  Â  Â  Â  Â  Â  <label for="level">Difficulty Level</label>
Â  Â  Â  Â  Â  Â  <select id="level" formControlName="level" required>
Â  Â  Â  Â  Â  Â  Â  <option value="" disabled>Select level...</option>
              @for (level of difficultyLevels; track level) {
                <option [value]="level">{{ level }}</option>
              }
Â  Â  Â  Â  Â  Â  </select>
            @if (uploadForm.get('level')?.invalid && uploadForm.get('level')?.touched) {
                <div class="error-message">Level is required.</div>
            }
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
        
Â  Â  Â  Â  Â  Â  Â  Â  <div class="input-row">
Â  Â  Â  Â  Â  <div class="input-group full-width">
Â  Â  Â  Â  Â  Â  <label for="description">Description (Optional)</label>
Â  Â  Â  Â  Â  Â  <input id="description" type="text" formControlName="description" placeholder="Short description of the sheet..." />
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="input-row">
Â  Â  Â  Â  Â  <div class="input-group full-width">
Â  Â  Â  Â  Â  Â  <label for="instruments">Instruments (Multi-select)</label>
Â  Â  Â  Â  Â  Â  <select id="instruments" formControlName="instruments" multiple size="4">
              @for (inst of instrumentsList; track inst.id) {
Â  Â  Â  Â  Â  Â      <option [value]="inst.id">{{ inst.name }}</option>
              }
Â  Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="upload-section">
Â  Â  Â  Â  Â  <label>Upload Files</label>
Â  Â  Â  Â  Â  <div class="drop-zone" (click)="fileInput.click()" (drop)="onFileDrop($event)" (dragover)="onFileDragOver($event)">
Â  Â  Â  Â  Â  Â  <div class="drop-icon">ðŸ“„</div>
Â  Â  Â  Â  Â  Â  <p>{{ selectedFile ? selectedFile.name : 'Drop PDF files here' }}</p>
Â  Â  Â  Â  Â  Â  <p class="supported-formats">Supported formats: PDF</p>
Â  Â  Â  Â  Â  Â  <input type="file" #fileInput (change)="onFileSelect($event)" style="display: none;" accept=".pdf" />
Â  Â  Â  Â  Â  </div>
         @if (!selectedFile && uploadForm.touched) { 
    <div class="error-message">A file is required for upload.</div>
}
          @if (uploadError) {
            <div class="error-message general-error">{{ uploadError }}</div>
          }
Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="modal-footer">
Â  Â  Â  Â  Â  <button type="button" class="cancel-btn" (click)="onCancel()">Cancel</button>
Â  Â  Â  Â  Â  <button type="submit" class="button" [disabled]="!uploadForm.valid || !selectedFile || isLoading">
            @if (isLoading) {
                <span>Uploading...</span>
            } @else {
                <span>Upload Sheet</span>
            }
          </button>
Â  Â  Â  Â  </div>
Â  Â  Â  </form>
Â  Â  </div>
</div>
}